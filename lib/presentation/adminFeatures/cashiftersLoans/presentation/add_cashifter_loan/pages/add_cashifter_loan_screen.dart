import 'package:flutter/material.dart';import 'package:shiftapp/presentation/adminFeatures/usersManagement/presentation/addNewUser/widgets/company_picker.dart';import 'package:shiftapp/presentation/shared/components/app_cupertino_button.dart';import '../../../../../presentationUser/common/common_state.dart';import '../../../../../presentationUser/loan_requests/add_new_loan_request/widgets/warning_check_box_widget.dart';import '../../../../../shared/components/base_stateless_widget.dart';import '../../../../../shared/components/text_field/build_text_field_item.dart';import '../../../data/models/add_cashifter_loan_params.dart';import '../bloc/add_cashifter_loan_state.dart';import '../widgets/cashifter_discount_percentage_picker.dart';import '../widgets/cashifter_loan_type_picker.dart';import '../widgets/cashifter_name_picker.dart';import '../widgets/loan_terms.dart';class AddCashifterLoanScreen extends BaseStatelessWidget {  final AddCashifterLoanState state;  final Function(int) onFetchCashifters;  final Function(AddCashifterLoanParams) onAddCashifterLoan;  AddCashifterLoanScreen({    Key? key,    required this.state,    required this.onFetchCashifters,    required this.onAddCashifterLoan,  }) : super(key: key);  var amountController = TextEditingController();  StreamState<String> descriptionStream = StreamStateInitial();  StreamState<bool> isGuarantorStream = StreamStateInitial();  StreamState<bool> isAgreeStream = StreamStateInitial();  final _formKey = GlobalKey<FormState>();  int loanTypeId = 0;  String loanTypeCrmValue = '';  int loansAmount = 0;  int monthId = 0;  String idNumber = '';  AddCashifterLoanParams params = AddCashifterLoanParams();  @override  Widget build(BuildContext context) {    return Form(      key: _formKey,      child: SingleChildScrollView(        padding: const EdgeInsets.all(16),        child: Column(          children: [            CompanyPicker(              items: state.companies ?? [],              onSelectItem: (value) {                params.companyId = value.index;                onFetchCashifters(value.index);              },            ),            CashifterNamePicker(              cashiftersStream: state.cashiftersStream,              onSelectItem: (value) {                params.freelenceId = value.index;              },            ),            CashifterLoanTypePicker(              items: state.loansTypes ?? [],              onSelectItem: (value) {                params.loanTypeId = value.index;              },            ),            BuildTextFieldItem(              title: strings.loan_value,              hintText: strings.type_loan_value,              controller: amountController,            ),            CashifterDiscountPercentagePicker(              items: state.discountPercentages ?? [],              onSelectItem: (value) {                params.deductPercentage = value.index;              },            ),            WarningCheckBoxWidget(              descriptionStream: descriptionStream,              onChanged: (value) {                isAgreeStream.setData(value ?? false);              },            ),            LoanTermsList(              items: state.cashiftLoanTermsAndConditions ?? [],            ),            AppCupertinoButton(              text: strings.save_button,              margin: const EdgeInsets.only(top: 30),              onPressed: () {                if (_formKey.currentState!.validate()) {                  params.loanValue = int.parse(amountController.text);                  onAddCashifterLoan(params);                }              },            ),          ],        ),      ),    );  }}